# Rule to mitigate CVE-2022-26134
# Sample exploit snippet: ${@java.lang.Runtime@getRuntime().exec("whoami")}
# regex matching for ().exec(
when RULE_INIT {
    # enable (1) / disable (0) logging
    set static::debug_logging 1
}
when HTTP_REQUEST {
    if { [URI::decode [HTTP::uri -normalized]] matches_regex {\(\)\.exec\(} } {
        if { $static::debug_logging } { log local0. "Rejected because HTTP request suspicious to be CVE-2021-44228" }
        reject
    }    
}